<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 初入 Ubuntu 的一些操作 · Lei's blog</title><meta name="description" content="初入 Ubuntu 的一些操作 - Zhang Lei"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Lei's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/leizhang233" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/zhanglei12345" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">初入 Ubuntu 的一些操作</h1><div class="post-info">Jan 16, 2019</div><div class="post-content"><h3 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h3><p><code>cat /etc/os-release</code></p>
<h3 id="修改-root-密码"><a href="#修改-root-密码" class="headerlink" title="修改 root 密码"></a>修改 root 密码</h3><p><code>passwd</code></p>
<h3 id="新建用户"><a href="#新建用户" class="headerlink" title="新建用户"></a>新建用户</h3><p>新建用户：</p>
<p><code>adduser username</code></p>
<p>将新用户加入 sudo 组,这样就可以用 sudo 命令了：</p>
<p><code>gpasswd sudo -a username</code></p>
<blockquote>
<p>若不执行此操作，执行 sudo 命令时，会提示 username is not in the sudoers file.  This incident will be reported.</p>
</blockquote>
<h3 id="更改-ssh-默认端口"><a href="#更改-ssh-默认端口" class="headerlink" title="更改 ssh 默认端口"></a>更改 ssh 默认端口</h3><p><code>sudo vi /etc/ssh/sshd_config</code> ，修改 Port 自定义端口号，之后重启 ssh 服务：<code>sudo systemctl restart sshd.service</code> ，根据自己需要看是否禁止 root 用户登录，修改配置文件：<code>PermitRootLogin no</code>，之后重启 ssh 服务。</p>
<a id="more"></a>
<h3 id="ssh-免密登陆"><a href="#ssh-免密登陆" class="headerlink" title="ssh 免密登陆"></a>ssh 免密登陆</h3><p>本机生成密钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/.ssh/vps</span><br><span class="line">ssh-keygen -t rsa -C <span class="string">"***@gmail.com"</span> -f ~/.ssh/vps/id_rsa</span><br></pre></td></tr></table></figure>
<p>config 文件配置，在 ~/.ssh/ 下新建 config 文件， <code>vi config</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># vps configuration</span><br><span class="line">Host vps</span><br><span class="line">	HostName ***.***.***.***</span><br><span class="line">	Port ***</span><br><span class="line">	IdentityFile ~/.ssh/vps/id_rsa</span><br><span class="line">	User ***</span><br></pre></td></tr></table></figure>
<p>本机登陆 vps, 需要输入密码：</p>
<p><code>ssh vps</code></p>
<p>创建 .ssh 目录：</p>
<p><code>cd ~;mkdir .ssh</code></p>
<p>本机将公钥拷贝至 vps 的用户的 .ssh 目录下, 需要输入密码：</p>
<p><code>scp id_rsa.pub vps:~/.ssh/authorized_keys</code></p>
<p>修改 vps 上 authorized_keys 文件权限：</p>
<p><code>chmod 600 authorized_keys</code></p>
<p>之后可实现本机免密登陆 vps。</p>
<h3 id="安装-vim"><a href="#安装-vim" class="headerlink" title="安装 vim"></a>安装 vim</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install vim</span><br></pre></td></tr></table></figure>
<h3 id="安装-ftp"><a href="#安装-ftp" class="headerlink" title="安装 ftp"></a>安装 ftp</h3><p><a href="http://wiki.ubuntu.org.cn/Vsftpd" target="_blank" rel="noopener">参考链接</a>  </p>
<p>安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ftp</span><br><span class="line">sudo apt install vsftpd</span><br><span class="line"><span class="comment"># 查看是否打开21端口</span></span><br><span class="line">sudo netstat -npltu | grep 21</span><br><span class="line"><span class="comment"># 登录</span></span><br><span class="line">ftp localhost</span><br></pre></td></tr></table></figure>
<p>修改配置文件 /etc/vsftpd.conf：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 设置控制连接的监听端口号，默认为21</span><br><span class="line">listen_port=&lt;port&gt;</span><br><span class="line"># 是否开放本地用户的写权限</span><br><span class="line">write_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line"># 限制一切用户登录，只允许列表文件中的用户，用 userlist_file</span><br><span class="line">userlist_enable=YES</span><br><span class="line">userlist_deny=NO</span><br><span class="line">userlist_file=/etc/vsftpd.user_list</span><br></pre></td></tr></table></figure>
<p>创建 /etc/vsftpd.user_list，写入只允许登录的用户名。</p>
<p>启动服务：</p>
<p><code>sudo service vsftpd start</code></p>
<h3 id="安装-git"><a href="#安装-git" class="headerlink" title="安装 git"></a>安装 git</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install git</span><br></pre></td></tr></table></figure>
<h3 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h3><p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">Docker 官方安装教程</a></p>
<p>设置存储库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install apt-transport-https ca-certificates curl software-properties-common</span><br><span class="line"><span class="comment"># Add Docker’s official GPG key</span></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line"><span class="comment"># 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88</span></span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line">sudo add-apt-repository <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu <span class="variable">$(lsb_release -cs)</span> stable"</span></span><br></pre></td></tr></table></figure>
<p>安装 DOCKER CE： </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line"><span class="comment"># Install the latest version of Docker CE</span></span><br><span class="line">sudo apt install docker-ce</span><br><span class="line"><span class="comment"># Verify that Docker CE is installed correctly by running the hello-world image.</span></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>
<p>启动 Docker CE：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> docker </span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<p>建立 docker 用户组：</p>
<p>默认情况下，docker 命令会使用 Unix socket 与 Docker 引擎通讯。而只有 root 用户和 docker 组的用户才可以访问 Docker 引擎的 Unix socket。出于安全考虑，一般 Linux 系统上不会直接使用 root 用户。因此，更好地做法是将需要使用 docker 的用户加入 docker 用户组。</p>
<p>建立 docker 组：</p>
<p><code>sudo groupadd docker</code></p>
<p>将当前用户加入 docker 组：</p>
<p><code>sudo usermod -aG docker $USER</code></p>
<h3 id="搭建-shadowsocks"><a href="#搭建-shadowsocks" class="headerlink" title="搭建 shadowsocks"></a>搭建 shadowsocks</h3><p>从 <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a> 下载自己建立的镜像。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取镜像</span></span><br><span class="line">docker pull zhanglei12345/shadowsocks-libev</span><br><span class="line"><span class="comment"># 启动容器</span></span><br><span class="line">docker run --restart=always -d -p hostPort:containerPort zhanglei12345/shadowsocks-libev:latest -s 0.0.0.0 -p containerPort -k mypassword -m aes-256-cfb</span><br></pre></td></tr></table></figure>
<h3 id="搭建-shadowsocksr"><a href="#搭建-shadowsocksr" class="headerlink" title="搭建 shadowsocksr"></a>搭建 shadowsocksr</h3><p>从 <a href="https://hub.docker.com/" target="_blank" rel="noopener">Docker Hub</a> 下载自己建立的镜像。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取镜像</span></span><br><span class="line">docker pull zhanglei12345/shadowsocksr</span><br><span class="line"><span class="comment"># 启动容器</span></span><br><span class="line">docker run --restart=always -d -p hostPort:containerPort zhanglei12345/shadowsocksr:latest -p containerPort -k mypassword -m aes-256-cfb -O auth_sha1_v4 -o http_simple</span><br></pre></td></tr></table></figure>
<h3 id="安装-Docker-Compose"><a href="#安装-Docker-Compose" class="headerlink" title="安装 Docker Compose"></a>安装 Docker Compose</h3><p><a href="https://github.com/docker/compose/releases" target="_blank" rel="noopener">Releases · docker/compose · GitHub</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载对应版本</span></span><br><span class="line">sudo curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.23.2/docker-compose-<span class="variable">$(uname -s)</span>-<span class="variable">$(uname -m)</span>"</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"><span class="comment"># 赋执行权限</span></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"><span class="comment"># 检查版本号</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/2018/08/23/Hexo搭建/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'https-zhanglei12345-github-io';
var disqus_identifier = '2019/01/16/初入Ubuntu的一些操作/';
var disqus_title = '初入 Ubuntu 的一些操作';
var disqus_url = 'http://yoursite.com/2019/01/16/初入Ubuntu的一些操作/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//https-zhanglei12345-github-io.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2019 <a href="http://yoursite.com">Zhang Lei</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>